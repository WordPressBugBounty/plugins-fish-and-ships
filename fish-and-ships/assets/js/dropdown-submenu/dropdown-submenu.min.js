!function(e){function t(t){d(t,e(t).val())!=e(t).attr("data-dropdown-changes-control")&&s(t)}function s(t){if(!a(t))return!1;var s=e(t).parent().parent(),o=r(t);e(s).removeClass("dropdown-submenu-flag dropdown-submenu-open is-disabled is-hidden"),o.watchDisabled&&e(t).attr("disabled")&&e(s).addClass("is-disabled"),o.watchHidden&&e(t).attr("hidden")&&e(s).addClass("is-hidden"),e(".dropdown-field",s).remove(),c(t),l(t)}function o(t,s){e(t).css("width",e(s).outerWidth())}function n(t){maybe_ancestor=e(".dropdown-selected",t).parent().closest("li"),e(t).has(maybe_ancestor).length&&e(maybe_ancestor).addClass("dropdown-ancestor-selected")}function d(t,s){var o=e(t).clone();e("cloned").find("option:selected").prop("selected",!1);var n=e(o).html();o=null;var d=r(t);return d.watchDisabled&&(n+="disabled:"+(e(t).attr("disabled")?"1":"0")),d.watchHidden&&(n+="hidden:"+(e(t).attr("hidden")?"1":"0")),d.watchSelectClasses&&(classes=e(t).attr("class"),classes=classes.replace("dropdown-submenu-tuned",""),""!=classes&&(n+="classes:"+classes)),function(e){for(var t=0,s=0;s<e.length;s++){var o=e.charCodeAt(s);t=(t<<5)-t+o,t&=t}return t}(n+s)}function a(t){return"SELECT"==e(t).prop("tagName")&&e(t).hasClass("dropdown-submenu-tuned")}function r(t){var s=e(t).attr("data-dropdown-submenu-id");return u[s]?u[s]:def_settings}function i(t){text="Unknown",e(t).attr("data-html-option")&&""!=e(t).attr("data-html-option")?text=e(t).attr("data-html-option"):"OPTGROUP"==e(t).prop("tagName")?text=e(t).attr("label"):text=e(t).text();try{try_text=decodeURIComponent(text),text=try_text}catch(e){}return icon="",e(t).attr("data-icon")&&""!=e(t).attr("data-icon")&&(icon='<span class="icon"><img src="'+e(t).attr("data-icon")+'" /></span>'),icon+text}function l(t){var s=e(t).attr("data-dropdown-submenu-id");p[s]={object:t,currentValue:e(t).val(),watchChangeVal:u[s].watchChangeVal,minScreenWidth:u[s].minScreenWidth}}function c(t){var s=r(t),a=e(t).val(),l=e(t).parent().parent();o(l,t);var c=e("<div/>",{class:"dropdown-field"}).appendTo(l);s.watchSelectClasses&&(classes=e(t).attr("class"),classes=classes.replace("dropdown-submenu-tuned",""),""!=classes&&e(c).addClass(classes));var u=e("<div/>",{class:"dropdown-field-watch"}).appendTo(c);e("<div/>",{html:i(e(":selected",t)),class:"content"}).appendTo(u),e("<div/>",{class:"dropdown-arrow"}).appendTo(u),list=e("<ul/>",{class:"dropdown-main-list"}),e(t).children().each(function(t,o){if("OPTGROUP"==e(o).prop("tagName")){child_list=e("<ul/>",{class:"dropdown-submenu"}),e(o).children().each(function(t,o){var n="dropdown-submenu-item"+(e(o).val()==a?" dropdown-selected":"");s.copyOptionClasses&&e(o).attr("class")&&(n+=" "+e(o).attr("class")),e("<li/>",{html:i(o),"data-value":e(o).val(),class:n}).appendTo(child_list)});n="dropdown-main-item dropdown-has-childs";s.copyOptionClasses&&e(o).attr("class")&&(n+=" "+e(o).attr("class")),ancor=e("<li/>",{class:n}).appendTo(list),e("<div/>",{html:i(o),class:"content"}).appendTo(ancor),e("<div/>",{class:"dropdown-arrow"}).appendTo(ancor),e(child_list).appendTo(ancor)}if("OPTION"==e(o).prop("tagName")){var n="dropdown-main-item dropdown-no-childs"+(e(o).val()==a?" dropdown-selected":"");s.copyOptionClasses&&e(o).attr("class")&&(n+=" "+e(o).attr("class")),e("<li/>",{html:i(o),"data-value":e(o).val(),class:n}).appendTo(list)}}),e(list).appendTo(c),n(c);var p=d(t,a);e(t).attr("data-dropdown-changes-control",p),e(".dropdown-no-childs, .dropdown-submenu-item",l).mouseover(function(){e(".dropdown-selected",l).removeClass("accent-hover"),e(this).addClass("accent-hover")}).mouseout(function(){e(this).removeClass("accent-hover"),e(".dropdown-selected",l).addClass("accent-hover")}),e(".dropdown-has-childs",l).mouseover(function(){!function(t){$MainMenu=e(t).closest(".dropdown-main-list"),screenMainMenuBottomY=e($MainMenu).offset().top-f+e($MainMenu).outerHeight(),screenWrapperPosY=e(t).offset().top-f,screenSubmenuPosY=e(".dropdown-submenu",t).offset().top-f,submenuHeight=e(".dropdown-submenu",t).outerHeight(),will_out_top=screenMainMenuBottomY-submenuHeight<10,will_out_bottom=screenWrapperPosY+submenuHeight+10>m,is_out_top=screenSubmenuPosY<10,is_out_bottom=screenSubmenuPosY+submenuHeight+10>m,is_out_top&&!will_out_bottom?e(t).addClass("child-always-bottom"):is_out_bottom&&!will_out_top?e(t).addClass("child-always-top"):is_out_bottom?(e(t).addClass("child-js-pos"),screenJsPosY=m-submenuHeight-10,e(".dropdown-submenu",t).css("margin-top",screenJsPosY-screenWrapperPosY)):is_out_top&&(e(t).addClass("child-js-pos"),screenJsPosY=10,e(".dropdown-submenu",t).css("margin-top",screenJsPosY-screenWrapperPosY))}(this)}).mouseout(function(){e(this).removeClass("child-js-pos child-always-bottom child-always-top"),e(".dropdown-submenu",this).css("margin-top","")}),e(".dropdown-field-watch",l).mousedown(function(t){if("1"==t.which){if(e(l).hasClass("is-disabled"))return!1;e(l).toggleClass("dropdown-submenu-open"),e(".dropdown-submenu-open").not(l).removeClass("dropdown-submenu-open"),function(t){screenPosY=e(t).offset().top-f,open_top=!1,screenPosY>m/2&&(dropdownHeight=e(".dropdown-main-list",t).height(),screenPosY+dropdownHeight+40>m&&(open_top=!0));e(t).toggleClass("open-top",open_top)}(l),function(t,s){if("left"==s)return void e(t).removeClass("open-left");if("right"==s)return void e(t).addClass("open-left");var o=0;screenPosX=e(t).offset().left-v+e(t).outerWidth(),e(".dropdown-submenu",t).each(function(t,s){o<e(s).outerWidth()&&(o=e(s).outerWidth())}),right_right=screenPosX+o+10>w&&screenPosX-o>0,e(t).toggleClass("open-left",right_right)}(l,s.openSide)}}),e(".dropdown-field, .dropdown-has-childs",l).click(function(){return!1}),e(".dropdown-submenu-item, .dropdown-no-childs",l).click(function(){var s=e(this).attr("data-value"),o="dropdown-field-watch "+e(this).attr("class");o=(o=(o=o.replace("dropdown-submenu-item","")).replace("dropdown-selected","")).replace("accent-hover",""),e(".dropdown-selected, .dropdown-ancestor-selected",l).removeClass("dropdown-selected dropdown-ancestor-selected"),e(this).addClass("dropdown-selected"),n(l);var a=d(t,s);return e(t).attr("data-dropdown-changes-control",a),e(".dropdown-field-watch .content",l).html(e(this).html()),e(".dropdown-field-watch",l).attr("class",o),e("select",l).val(s),e(l).removeClass("dropdown-submenu-open"),e("select",l).trigger("change"),!1}),e(document).trigger("dropdown-submenu-tuned",e("select",l)),e(document).trigger("dropdown-submenu-newfield",c)}var u=[],p=[],h=e(window),w=h.width(),m=h.height(),f=h.scrollTop(),v=h.scrollLeft();e.fn.dropdownSubmenu=function(n){var d={minScreenWidth:500,watchDisabled:!0,watchSelectClasses:!0,watchHidden:!0,watchChangeVal:!1,copyOptionClasses:!0,wrapClass:"dropdown-submenu-wrapper",tuneClass:"dropdown-submenu-skin",customClass:"",openSide:"auto"},r=0,i="";return"string"==typeof n&&(i=n,n={}),this.filter("select").each(function(){if(""==i){if(a(this))return s(this),!0;var p=this,h=e.extend(d,n);u[++r]=h;var m=h.wrapClass+" "+h.tuneClass+" "+h.customClass;h.minScreenWidth>w?m+=" not-fit":m+=" fits-well",h.watchDisabled&&(m+=e(this).attr("disabled")?" is-disabled":""),h.watchHidden&&(m+=e(this).attr("hidden")?" is-hidden":""),e(this).addClass("dropdown-submenu-tuned").attr("data-dropdown-submenu-id",r).wrap('<div class="'+m+'"><div class="dropdown-submenu-hidden"></div></div>'),l(this);var f=new MutationObserver(function(){t(p)});f.observe(this,{attributes:!0,childList:!1,subtree:!1}),c(this)}else if("refresh"==i)s(this);else if("refresh-width"==i){if(!a(this))return!1;o(v=e(this).parent().parent(),this)}else if("destroy"==i){if(!a(this))return!1;var v=e(this).parent().parent();void 0!==f&&!1!==f&&f.disconnect(),e(".dropdown-field",v).remove(),e(this).removeClass("dropdown-submenu-tuned").unwrap("div").unwrap("div")}else console.error("[dropdown-submenu] Unknown action: "+i)}),this},h.resize(function(){w=h.width(),m=h.height(),f=h.scrollTop(),v=h.scrollLeft(),jQuery(p).each(function(t,s){if(void 0!==s&&0!=s){var o=e(s.object).parent().parent();s.minScreenWidth>w?e(o).addClass("not-fit").removeClass("fits-well"):e(o).addClass("fits-well").removeClass("not-fit")}})}),e(window).scroll(function(){f=h.scrollTop(),v=h.scrollLeft()}),e(document).on("change","select.dropdown-submenu-tuned",function(){t(this)}),setInterval(function(){jQuery(p).each(function(s,o){void 0!==o&&0!=o&&o.watchChangeVal&&e(o.object).val()!=o.currentValue&&t(o.object)})},100),e(document).on("click",function(){e(".dropdown-submenu-open").removeClass("dropdown-submenu-open")})}(jQuery);